--listing changes
select distinct SpcRecID from (
SELECT TOP 508 
  S.SpcRecID, 
  F.FamName, G.GenName, S.SpcName, L.LegListing, L.LegDateListed, C.CtyRecID, L.LegNotes
FROM ORWELL.plants.dbo.species AS S
  INNER JOIN ORWELL.plants.dbo.genus AS G ON S.SpcGenRecID = G.GenRecID 
  INNER JOIN ORWELL.plants.dbo.family AS F ON G.GenFamRecID = F.FamRecID 
  INNER JOIN ORWELL.plants.dbo.legal AS L ON S.SpcRecID = L.LegSpcRecID
  INNER JOIN ORWELL.plants.dbo.legalname AS LN ON L.LegLnmRecID = LN.LnmRecID AND LN.LnmRecID = 3
  LEFT JOIN ORWELL.plants.dbo.Country as C ON L.LegISO2 = C.CtyISO2
WHERE S.SpcStatus = 'A'
ORDER BY 2,3,4
) q

-- species
Select 'Plantae' as Kingdom , 
--P.PhyName, C.ClaName, 
O.OrdName, F.FamName, G.GenName, S.Spcname, S.SpcInfraRank, S.SpcInfraepithet, S.Spcrecid, S.SpcStatus
from Orwell.plants.dbo.Species S 
inner join Orwell.plants.dbo.Genus G on S.Spcgenrecid = G.genrecid
INNER JOIN	ORWELL.plants.dbo.Family F ON FamRecID = GenFamRecID
INNER JOIN  ORWELL.plants.dbo.TaxOrder O ON OrdRecID = FamOrdRecID
--LEFT JOIN  ORWELL.plants.dbo.TaxClass C ON ClaRecID = OrdClaRecID
--LEFT JOIN  ORWELL.plants.dbo.TaxPhylum P ON PhyRecID = ClaPhyRecID
WHERE S.SpcRecID IN (
1482,1483,1484,1485,5610,7428,8451,8551,8552,8554,8555,8556,8602,8603,8607,8610,8611,8772,8916,8961,9007,9440,24140,24141,24148,24200,24203,24365,24432,24485,24530,24539,24553,24680,24736,25001,30348,31571,31969,31970,32758,32808,33332,34211,34231,39600,47094,47095,47171,49806,62326,62327,70152,76435,80781,80782,105303,106032,106033,106035,106036,106037,106038,106039,106105,106106,106107,113119,113154,120271,150609,158451,158619,159698,160439,160440,160441,160442,161447,161467,161848,162304,170747,170748,170749,170750,170751,170752,170753,170754,185009,185010,185011,185012,185013,185014,185042,185492,192415,192416,192460,192461
)
ORDER BY 5,6,7;

-- synonyms
Select 'Plantae' as Kingdom, O.OrdName, F.FamName, G.GenName, S.Spcname, S.SpcInfraepithet, S.Spcrecid, S.SpcStatus, SynSpcRecID AS AcceptedSpcRecID
from Orwell.plants.dbo.Species S 
inner join Orwell.plants.dbo.Genus G on S.Spcgenrecid = G.genrecid
INNER JOIN	ORWELL.plants.dbo.Family F ON FamRecID = GenFamRecID
INNER JOIN  ORWELL.plants.dbo.TaxOrder O ON OrdRecID = FamOrdRecID
INNER JOIN  ORWELL.plants.dbo.SynLink Syn ON SynParentRecID = S.SpcRecID
WHERE SynSpcRecID IN (
1482,1483,1484,1485,5610,7428,8451,8551,8552,8554,8555,8556,8602,8603,8607,8610,8611,8772,8916,8961,9007,9440,24140,24141,24148,24200,24203,24365,24432,24485,24530,24539,24553,24680,24736,25001,30348,31571,31969,31970,32758,32808,33332,34211,34231,39600,47094,47095,47171,49806,62326,62327,70152,76435,80781,80782,105303,106032,106033,106035,106036,106037,106038,106039,106105,106106,106107,113119,113154,120271,150609,158451,158619,159698,160439,160440,160441,160442,161447,161467,161848,162304,170747,170748,170749,170750,170751,170752,170753,170754,185009,185010,185011,185012,185013,185014,185042,185492,192415,192416,192460,192461
)
ORDER BY 2;

-- common names
Select C.ComName, L.LanDesc, S.SpcRecId
from Orwell.animals.dbo.Species S 
inner join Orwell.animals.dbo.CommonName C on C.ComSpcRecID = S.SpcRecID
INNER JOIN	ORWELL.animals.dbo.Language L ON L.LanRecID = C.ComLanRecID
WHERE S.SpcRecID IN (
1482,1483,1484,1485,5610,7428,8451,8551,8552,8554,8555,8556,8602,8603,8607,8610,8611,8772,8916,8961,9007,9440,24140,24141,24148,24200,24203,24365,24432,24485,24530,24539,24553,24680,24736,25001,30348,31571,31969,31970,32758,32808,33332,34211,34231,39600,47094,47095,47171,49806,62326,62327,70152,76435,80781,80782,105303,106032,106033,106035,106036,106037,106038,106039,106105,106106,106107,113119,113154,120271,150609,158451,158619,159698,160439,160440,160441,160442,161447,161467,161848,162304,170747,170748,170749,170750,170751,170752,170753,170754,185009,185010,185011,185012,185013,185014,185042,185492,192415,192416,192460,192461
) AND L.LanDesc IN ('English', 'Spanish', 'French')
ORDER BY 3;

-- distributions
Select S.Spcrecid, Cty.CtyRecID, Cty.CtyShort
from Orwell.plants.dbo.Species S 
INNER JOIN [Plants].[dbo].[DistribCty] Dcty ON S.SpcRecID = Dcty.DCtSpcRecID
INNER JOIN [Plants].[dbo].[Country] Cty ON Dcty.DCtCtyRecID = Cty.CtyRecID
WHERE S.SpcRecID IN (
1482,1483,1484,1485,5610,7428,8451,8551,8552,8554,8555,8556,8602,8603,8607,8610,8611,8772,8916,8961,9007,9440,24140,24141,24148,24200,24203,24365,24432,24485,24530,24539,24553,24680,24736,25001,30348,31571,31969,31970,32758,32808,33332,34211,34231,39600,47094,47095,47171,49806,62326,62327,70152,76435,80781,80782,105303,106032,106033,106035,106036,106037,106038,106039,106105,106106,106107,113119,113154,120271,150609,158451,158619,159698,160439,160440,160441,160442,161447,161467,161848,162304,170747,170748,170749,170750,170751,170752,170753,170754,185009,185010,185011,185012,185013,185014,185042,185492,192415,192416,192460,192461
)
ORDER BY 1;